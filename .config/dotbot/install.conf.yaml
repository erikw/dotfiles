- defaults:
    link:
      relink: true
    create:
      mode: 0700
    shell:
      stderr: true
      stdout: true

- clean: ['~']

- link:
    ~/.bashrc: .bashrc
    ~/.config: .config
    ~/.hushlogin: .hushlogin
    ~/.local/repos:
      path: .local/repos
      create: true
    ~/.zshenv: .zshenv
    ~/bin: bin

- create:
    - ~/dl
    - ~/pub
    - ~/src
    - ~/tmp
    - ~/.local/share/tig # Make tig use $XDG_DATA_HOME. Reference: https://wiki.archlinux.org/title/XDG_Base_Directory#Partial

- shell:
  - [git submodule update --init --recursive, Installing submodules]


# TODO disabled as of bug executing command twice: https://github.com/ssbanerje/dotbot-ifplatform/pull/4#issuecomment-1532112176
#- ifmacos:
#  - shell:
#    -
#      command: ~/bin/macos_config.sh
#      description: Running macos_config.sh
#      stdin: true

# TODO not working due to https://github.com/wonderbeyond/dotbot-if/issues/1
#- if:
#    cond: test $(uname) = Darwin
#    met:
#      - shell:
#        -
#          command: ~/bin/macos_config.sh
#          description: Running macos_config.sh
#          stdin: true

# Just always run this for now, until some plugin like ifmacos/if works.
- shell:
  -
    command: ~/bin/macos_config.sh
    description: Running macos_config.sh
    stdin: true
  -
    command: ~/bin/macos_install.sh
    description: Running macos_config.sh

# TODO rewrite using `if` as above.
#- ifmacos:
#    - brewfile:
#      - .config/homebrew/Brewfile
    # Disabled as of bug: https://github.com/wonderbeyond/dotbot-if/issues/1
    # Hanlded in macos_install.sh for now.
    #- if:
    #    cond: 'test -e ~/.config/homebrew/Brewfile.$(hostname)'
    #    met:
    #    - shell:
    #      - [git submodule update --init --recursive, Installing submodules]
- brewfile:
  - .config/homebrew/Brewfile


# TODO conditionally execute:  ~/bin/windows_install.ps1
  # ifplatform has no ifwindows
  # But could do something like
    #- if:
    #    cond: 'echo "$OSTYPE | grep -q "msys*"'
